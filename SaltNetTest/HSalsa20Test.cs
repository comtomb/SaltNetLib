using TomB.SaltNet;
using TomB.SaltNet.Salsa20;
using System;
using System.Collections.Generic;
using System.Text;
using Xunit;
using TomB.ByteUtilNetLib;

namespace SaltNetLibTest
{
    public class HSalsa20Test
    {
        [Theory]
        [InlineData("167CADF9D63ED8B499A1E8B2B2C691B7F94B4FF42A14D82648AB0669595385C9", "00000000000000000000000000000000", null, "7106068BFB11341F4C45BEA368976C86B349179E7473F7ED8BEE8AC63E732580")]
        [InlineData("5DBE8B8FC0CC3AFC21735FA220A055326EBD67A162381F4F833C1135E557374C", "00000000000000000000000000000000", "7850F5DD459DB4409481BD67856ED3F9","CCC8A91DF8ED26E2552FE5C75BEEB2DCDEB6D21F86B9B96D0ABA2F4746C8F6DC")]
        [InlineData("D22DC1D9EC39C90B114E67E82B308BB990F0492C8D8D38057A339D1E6B327807","1CD3C29979BE97F588EB48937CA36609", "0C54B210BF7A0545F4BB5FB99CAA9FDF", "44589410B258460186BB35811C44DCA82270DF5105B28ED1D2A28B45AF4E9F96")]
        [InlineData("D560CC576DF240D15853A3A245A488D7CC9311167F6847A2CD7DA4BD5EDE58DD","4B69BE1CD60E9C1A14E1B86BD6630050", "3288EC0899895F6D182A89EF4D827279", "008D65801006F9F8646C4B58F53B1187943EA4AFD01C71B4231D2DBC25A356E2")]
        [InlineData("FAC656DBE56C00BEF7F6019EAFDCCB6A7C548AD6F25044C2095104AC84ACCD92","6E3F700F0C246AC6882E11A287C0BD3B", "5E1E72F9F89C87AA8293D2946753394A", "B74A88F39A9CE06AEC706884F96B6F0B435F514398E3CC9BB35A5BB3EE4EBD31")]
        [InlineData("296F30706BBC5E58E9C34DC33EA13B4993C84E6639D39AD1B7C58D7952D65F35","F5C77817904DCFA1C01A10344EC36CE0", "5788009E04D21156D55EB8A52EE40513", "B0F3FA3926F26B3E18D425C1AE8737320C874922B69E7F0D132F96535910B22A")]
        public void TestHSalsa20(String key,String input,String cst,String hash)
        {
            IXSalsa20 hsalsa = new XSalsa20Impl();
            byte[] inp = ByteUtil.HexToByteArray(input);
            byte[] c = cst != null ? ByteUtil.HexToByteArray(cst) : null;
            byte[] k = ByteUtil.HexToByteArray(key);
            byte[] h = ByteUtil.HexToByteArray(hash);
            byte[] mac = new byte[32];
            hsalsa.HSalsa20(mac, 0, inp, 0, k, 0, c, 0);
            Assert.Equal(mac, h);

        }

    }
}
